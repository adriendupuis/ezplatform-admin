<div>
    <p>Find good and bad examples for each field of a content type</p>
    <dl>
        <dt>Good Example</dt>
        <dd>A content having this optional field not empty, the maximum of other optional field not empty and no empty required field.</dd>
        <dt>Bad Example</dt>
        <dd>A content having this required field empty. (For example, it can happen when a field has become required but previous content haven't been updated.)</dd>
    </dl>
</div>
<fieldset>
    <legend>Content Type</legend>
    <select id="example_finder_content_type">
            <option value="">Select a content type…</option>
        {% for content_type_group in content_type_list %}
            <option disabled value="">{{ content_type_group.itself.identifier }}</option>
            {% for content_type in content_type_group.content_types %}
                <option value="{{ content_type.identifier }}">
                    {{ content_type.name }}
                </option>
            {% endfor %}
        {% endfor %}
        {# TODO: Remove before release #}<option value="unknown">Unknown content type!</option>
    </select>
</fieldset>
<script>
    {# TODO: Move to a .js file #}
    {% set content_type_placeholder = '+content_type+' %}
    $(function() {
        let contentType, exampleFinder = new ExampleFinder(
            '{{ path('ad_admin.content_usage.example_finder.search', {content_type: content_type_placeholder}) }}'.replace('{{ content_type_placeholder }}', ''),
            '#example_finder_result', '#example_finder_status');
        $('#example_finder_content_type').val('').change(function() {
            if ($(this).val()) {
                $('#example_finder_status').text('Initializing field table…');
                contentType = $(this).val();
                $('#example_finder_result').load(
                    '{{ path('ad_admin.content_usage.example_finder.table', {content_type: content_type_placeholder}) }}'.replace('{{ content_type_placeholder }}', contentType),
                    function (response, status, xhr) {
                        if ('error' === status) {
                            $('#example_finder_status').text(xhr.statusText);
                            $('#example_finder_result').html('');
                        } else {
                            $('#example_finder_status').text('Ready to search…');
                            exampleFinder.setContentType(contentType).search();
                        }
                    }
                );
            }
        });
    });

</script>
<div>Example Finder status: <em id="example_finder_status">Waiting for Content Type selection…</em></div>
<div id="example_finder_result"></div>